<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist - Automatizace</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        header {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 1em;
        }
        .container {
            max-width: 800px;
            margin: 2em auto;
            padding: 0 1em;
        }
        .checklist {
            background: white;
            padding: 2em;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .checklist h2 {
            color: #2c3e50;
            margin-bottom: 1em;
        }
        .checklist-item {
            margin-bottom: 1.5em;
            padding: 1em;
            border-bottom: 1px solid #eee;
        }
        .task-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5em;
        }
        .subtask-list {
            margin-left: 2em;
            margin-top: 0.5em;
            padding-left: 1em;
            border-left: 2px solid #ddd;
        }
        .subtask-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5em;
        }
        .checklist-item input[type="checkbox"],
        .subtask-item input[type="checkbox"] {
            margin-right: 1em;
        }
        .checklist-item label,
        .subtask-item label {
            font-size: 1.1em;
            flex-grow: 1;
        }
        .completed {
            text-decoration: line-through;
            color: #888;
        }
        .delete-btn, .edit-btn {
            margin-left: 0.5em;
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 0.3em 0.6em;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9em;
        }
        .edit-btn {
            background-color: #3498db;
        }
        .delete-btn:hover {
            background-color: #c0392b;
        }
        .edit-btn:hover {
            background-color: #2980b9;
        }
        .add-task, .add-subtask {
            margin: 1em 0;
            display: flex;
            align-items: center;
        }
        .add-task input[type="text"],
        .add-subtask input[type="text"] {
            padding: 0.5em;
            width: 70%;
            margin-right: 1em;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .add-task button,
        .add-subtask button {
            padding: 0.5em 1em;
            background-color: #2c3e50;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        .add-task button:hover,
        .add-subtask button:hover {
            background-color: #34495e;
        }
        .auth-btn {
            margin: 1em 0;
            padding: 0.5em 1em;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        .login {
            background-color: #27ae60;
            color: white;
        }
        .logout {
            background-color: #e67e22;
            color: white;
        }
        @media (max-width: 600px) {
            .container {
                margin: 1em;
                padding: 0 0.5em;
            }
            .checklist-item {
                padding: 0.5em;
            }
            .add-task input[type="text"],
            .add-subtask input[type="text"] {
                width: 60%;
            }
            .task-header {
                flex-wrap: wrap;
            }
            .delete-btn, .edit-btn {
                margin-top: 0.5em;
            }
        }
    </style>
</head>
<body>
    <header><h1>Checklist</h1></header>
    <div class="container">
        <section class="checklist">
            <h2>Checklist projektu automatizace</h2>
            <button id="login-btn" class="auth-btn login">Přihlásit se Google</button>
            <button id="logout-btn" class="auth-btn logout" style="display:none;">Odhlásit se</button>
            <p id="user-info"></p>
            <div class="add-task" style="display:none;" id="task-controls">
                <input type="text" id="new-task" placeholder="Zadejte nový úkol">
                <button onclick="addTask()">Přidat úkol</button>
            </div>
            <div id="checklist-items"></div>
        </section>
    </div>
    <script type="module" src="auth.js"></script>
    <script type="module" src="tasks.js"></script>
</body>
</html><!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist - Automatizace</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        header {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 1em;
        }
        .container {
            max-width: 800px;
            margin: 2em auto;
            padding: 0 1em;
        }
        .checklist {
            background: white;
            padding: 2em;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .checklist h2 {
            color: #2c3e50;
            margin-bottom: 1em;
        }
        .checklist-item {
            margin-bottom: 1.5em;
            padding: 1em;
            border-bottom: 1px solid #eee;
        }
        .task-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5em;
        }
        .subtask-list {
            margin-left: 2em;
            margin-top: 0.5em;
            padding-left: 1em;
            border-left: 2px solid #ddd;
        }
        .subtask-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5em;
        }
        .checklist-item input[type="checkbox"],
        .subtask-item input[type="checkbox"] {
            margin-right: 1em;
        }
        .checklist-item label,
        .subtask-item label {
            font-size: 1.1em;
            flex-grow: 1;
        }
        .completed {
            text-decoration: line-through;
            color: #888;
        }
        .delete-btn, .edit-btn {
            margin-left: 0.5em;
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 0.3em 0.6em;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9em;
        }
        .edit-btn {
            background-color: #3498db;
        }
        .delete-btn:hover {
            background-color: #c0392b;
        }
        .edit-btn:hover {
            background-color: #2980b9;
        }
        .add-task, .add-subtask {
            margin: 1em 0;
            display: flex;
            align-items: center;
        }
        .add-task input[type="text"],
        .add-subtask input[type="text"] {
            padding: 0.5em;
            width: 70%;
            margin-right: 1em;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .add-task button,
        .add-subtask button {
            padding: 0.5em 1em;
            background-color: #2c3e50;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        .add-task button:hover,
        .add-subtask button:hover {
            background-color: #34495e;
        }
        .auth-btn {
            margin: 1em 0;
            padding: 0.5em 1em;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        .login {
            background-color: #27ae60;
            color: white;
        }
        .logout {
            background-color: #e67e22;
            color: white;
        }
        @media (max-width: 600px) {
            .container {
                margin: 1em;
                padding: 0 0.5em;
            }
            .checklist-item {
                padding: 0.5em;
            }
            .add-task input[type="text"],
            .add-subtask input[type="text"] {
                width: 60%;
            }
            .task-header {
                flex-wrap: wrap;
            }
            .delete-btn, .edit-btn {
                margin-top: 0.5em;
            }
        }
    </style>
</head>
<body>
    <header><h1>Checklist</h1></header>
    <div class="container">
        <section class="checklist">
            <h2>Checklist projektu automatizace</h2>
            <button id="login-btn" class="auth-btn login">Přihlásit se Google</button>
            <button id="logout-btn" class="auth-btn logout" style="display:none;">Odhlásit se</button>
            <p id="user-info"></p>
            <div class="add-task" style="display:none;" id="task-controls">
                <input type="text" id="new-task" placeholder="Zadejte nový úkol">
                <button onclick="addTask()">Přidat úkol</button>
            </div>
            <div id="checklist-items"></div>
        </section>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getDatabase, ref, onValue, set, remove, push } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyALhWs0vz-ZG84KWXXdF8CoMZu6b6zFuDQ",
            authDomain: "checklist-3aaa2.firebaseapp.com",
            databaseURL: "https://checklist-3aaa2-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "checklist-3aaa2",
            storageBucket: "checklist-3aaa2.appspot.com",
            messagingSenderId: "315001625337",
            appId: "1:315001625337:web:10d787a6c1440437166028",
            measurementId: "G-CX7TCLZDN3"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        const loginBtn = document.getElementById("login-btn");
        const logoutBtn = document.getElementById("logout-btn");
        const userInfo = document.getElementById("user-info");
        const taskControls = document.getElementById("task-controls");
        const checklistItems = document.getElementById("checklist-items");

        loginBtn.onclick = () => {
            signInWithPopup(auth, provider).catch(err => alert("Chyba: " + err.message));
        };

        logoutBtn.onclick = () => {
            signOut(auth);
        };

        onAuthStateChanged(auth, user => {
            if (user) {
                loginBtn.style.display = "none";
                logoutBtn.style.display = "inline-block";
                userInfo.textContent = "Přihlášen jako: " + user.displayName;
                taskControls.style.display = "block";
                loadTasks();
            } else {
                loginBtn.style.display = "inline-block";
                logoutBtn.style.display = "none";
                userInfo.textContent = "";
                taskControls.style.display = "none";
                checklistItems.innerHTML = "";
            }
        });

        window.addTask = function() {
            const newTaskInput = document.getElementById('new-task');
            const taskText = newTaskInput.value.trim();
            if (taskText === '') return;

            const tasksRef = ref(database, 'checklist');
            const newTaskRef = push(tasksRef);
            const newTaskId = newTaskRef.key;

            set(newTaskRef, { text: taskText, checked: false, subtasks: {} });
            newTaskInput.value = '';
        };

        window.editTask = function(taskId, currentText) {
            const newText = prompt("Upravit úkol:", currentText);
            if (newText && newText.trim() !== '') {
                const taskRef = ref(database, 'checklist/' + taskId);
                onValue(taskRef, snapshot => {
                    const taskData = snapshot.val();
                    set(taskRef, { ...taskData, text: newText.trim() });
                }, { onlyOnce: true });
            }
        };

        window.addSubtask = function(taskId) {
            const subtaskInput = document.getElementById(`subtask-input-${taskId}`);
            const subtaskText = subtaskInput.value.trim();
            if (subtaskText === '') return;

            const subtaskRef = ref(database, `checklist/${taskId}/subtasks`);
            const newSubtaskRef = push(subtaskRef);
            set(newSubtaskRef, { text: subtaskText, checked: false });
            subtaskInput.value = '';
        };

        window.deleteTask = function(taskId) {
            const taskRef = ref(database, 'checklist/' + taskId);
            remove(taskRef);
        };

        window.deleteSubtask = function(taskId, subtaskId) {
            const subtaskRef = ref(database, `checklist/${taskId}/subtasks/${subtaskId}`);
            remove(subtaskRef);
        };

        function setupCheckbox(taskId) {
            const checkbox = document.getElementById(taskId);
            const taskRef = ref(database, 'checklist/' + taskId);

            checkbox.addEventListener('change', function() {
                onValue(taskRef, snapshot => {
                    const taskData = snapshot.val();
                    set(taskRef, { ...taskData, checked: this.checked });
                }, { onlyOnce: true });
            });
        }

        function setupSubtaskCheckbox(taskId, subtaskId) {
            const checkbox = document.getElementById(subtaskId);
            const subtaskRef = ref(database, `checklist/${taskId}/subtasks/${subtaskId}`);

            checkbox.addEventListener('change', function() {
                onValue(subtaskRef, snapshot => {
                    const subtaskData = snapshot.val();
                    set(subtaskRef, { ...subtaskData, checked: this.checked });
                }, { onlyOnce: true });
            });
        }

        function loadTasks() {
            const tasksRef = ref(database, 'checklist');
            onValue(tasksRef, snapshot => {
                checklistItems.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const taskId = childSnapshot.key;
                    const taskData = childSnapshot.val();
                    const newItem = document.createElement('div');
                    newItem.className = 'checklist-item';
                    newItem.innerHTML = `
                        <div class="task-header">
                            <input type="checkbox" id="${taskId}" ${taskData.checked ? "checked" : ""}>
                            <label for="${taskId}" class="${taskData.checked ? "completed" : ""}">${taskData.text}</label>
                            <button class="edit-btn" onclick="editTask('${taskId}', '${taskData.text}')">Upravit</button>
                            <button class="delete-btn" onclick="deleteTask('${taskId}')">Smazat</button>
                        </div>
                        <div class="add-subtask">
                            <input type="text" id="subtask-input-${taskId}" placeholder="Zadejte nový podúkol">
                            <button onclick="addSubtask('${taskId}')">Přidat podúkol</button>
                        </div>
                        <div class="subtask-list" id="subtask-list-${taskId}"></div>
                    `;
                    checklistItems.appendChild(newItem);
                    setupCheckbox(taskId);

                    if (taskData.subtasks) {
                        const subtaskList = document.getElementById(`subtask-list-${taskId}`);
                        Object.entries(taskData.subtasks).forEach(([subtaskId, subtaskData]) => {
                            const subtaskItem = document.createElement('div');
                            subtaskItem.className = 'subtask-item';
                            subtaskItem.innerHTML = `
                                <input type="checkbox" id="${subtaskId}" ${subtaskData.checked ? "checked" : ""}>
                                <label for="${subtaskId}" class="${subtaskData.checked ? "completed" : ""}">${subtaskData.text}</label>
                                <button class="delete-btn" onclick="deleteSubtask('${taskId}', '${subtaskId}')">Smazat</button>
                            `;
                            subtaskList.appendChild(subtaskItem);
                            setupSubtaskCheckbox(taskId, subtaskId);
                        });
                    }
                });
            });
        }
    </script>
</body>
</html>
